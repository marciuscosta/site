{"id":107,"date":"2022-03-31T15:31:33","date_gmt":"2022-03-31T18:31:33","guid":{"rendered":"http:\/\/10.0.0.181\/?p=107"},"modified":"2022-04-01T18:06:47","modified_gmt":"2022-04-01T21:06:47","slug":"port-knocking-no-pfsense-usando-wazuh","status":"publish","type":"post","link":"http:\/\/10.0.0.181\/index.php\/2022\/03\/31\/port-knocking-no-pfsense-usando-wazuh\/","title":{"rendered":"Port Knocking no pfSense usando Wazuh"},"content":{"rendered":"\n<p>O cen\u00e1rio \u00e9 o seguinte:<\/p>\n\n\n\n<ul><li>Debian Bullseye vers\u00e3o 5.10.84-1 com wazuh-manager 4.2.6-1 e elasticsearch, kibana e filebeat nas vers\u00f5es 7.14.2<\/li><li>pfSense 2.6.0-RELEASE<\/li><li>Ambos os servidores acima foram virtualizados em VirtualBox 6.1.32 r149290 em Arch Linux 5.16.13-arch1-1<\/li><li>O artigo parte do princ\u00edpio que o wazuh-manager, wazuh-agent e o pfSense j\u00e1 estejam instalados, configurados e funcionais, como descrito acima.<\/li><li>IP do servidor com wazuh-manager: 10.0.2.201\/24<\/li><li>IP do servidor com pfSense: 10.0.2.200\/24 (LAN) e 10.0.0.200\/24 (WAN)<\/li><\/ul>\n\n\n\n<h2>..::| Objetivo<\/h2>\n\n\n\n<p>A t\u00e9cnica de Port Knocking consiste em estabelecer 3 ou mais portas aleat\u00f3rias que, se &#8220;tocadas&#8221; (ou seja, se &#8220;brevemente conectadas&#8221;) por um IP na sequ\u00eancia correta, far\u00e1 com que um script seja executado para liberar outra porta para o IP de origem desses toques. Mais informa\u00e7\u00f5es sobre essa t\u00e9cnica voc\u00ea encontra <a href=\"https:\/\/en.wikipedia.org\/wiki\/Port_knocking\" target=\"_blank\" rel=\"noreferrer noopener\">aqui<\/a>.<\/p>\n\n\n\n<p>Nesse artigo a inten\u00e7\u00e3o \u00e9 liberar o acesso ao pfSense, na porta &#8220;wan&#8221; dele, somente para um espec\u00edfico IP de origem quando esse conseguir tocar em 3 portas configuradas como &#8220;combina\u00e7\u00e3o de portas para libera\u00e7\u00e3o de conex\u00e3o&#8221;, e na sequ\u00eancia correta. Aqui descreverei a libera\u00e7\u00e3o das portas 80\/TCP e 22\/TCP, por\u00e9m s\u00f3 uma delas poder\u00e1 ser liberada para um IP de origem enquanto n\u00e3o expirar essa libera\u00e7\u00e3o.<\/p>\n\n\n\n<p>Essa libera\u00e7\u00e3o externa para acessar o pfSense possibilitar\u00e1 o administrador de redes a configurar remotamente o gateway de uma LAN, pois possibilitar\u00e1 acesso tanto via SSH quanto ao webadmin do pfSense. Como essas portas ser\u00e3o liberadas somente se o Port Knocking for acertado, evita-se diversos tipos de ataques a esse gateway, como o de for\u00e7a bruta, por exemplo. No caso desse artigo utilizei a porta 80, por\u00e9m \u00e9 sempre recomendado ativar o HTTPS do pfSense e desativar o acesso HTTP, para maior seguran\u00e7a ainda mais quando se est\u00e1 acessando-o da internet.<\/p>\n\n\n\n<h2>..::| Enviando registros ao wazuh-manager<\/h2>\n\n\n\n<p>Caso n\u00e3o tenha o acesso SSH ao servidor do pfSense habilitado, fa\u00e7a-o indo no menu <em>System -> Advanced -><\/em> marque a op\u00e7\u00e3o &#8220;<em>Enable Secure Shell<\/em>&#8221; e depois salve.<\/p>\n\n\n\n<p>Configure o agente do Wazuh no pfSense para ler e encaminhar o conte\u00fado do log <em>\/var\/log\/filter.log<\/em>. Abra o arquivo <em>\/var\/ossec\/etc\/ossec.conf<\/em> no pfSense e, depois do \u00faltimo <em>&lt;\/localfile><\/em> , adicione:<\/p>\n\n\n\n<pre class=\"wp-block-code\"><code>&lt;localfile>\n &lt;log_format>syslog&lt;\/log_format>\n &lt;location>\/var\/log\/filter.log&lt;\/location>\n&lt;\/localfile><\/code><\/pre>\n\n\n\n<p>Reinicie o agent:<\/p>\n\n\n\n<pre class=\"wp-block-code\"><code>\/usr\/local\/etc\/rc.d\/wazuh-agent restart<\/code><\/pre>\n\n\n\n<h2>..::| Script portknocking.sh<\/h2>\n\n\n\n<p>Esse script ser\u00e1 o respons\u00e1vel por verificar a sequ\u00eancia de portas tocadas, criar a regra de firewall para liberar acesso a porta solicitada caso a sequ\u00eancia de toques esteja correta, e tamb\u00e9m para excluir essa regra ap\u00f3s um per\u00edodo pr\u00e9-determinado a ser configurado no active-response do wazuh-manager.<\/p>\n\n\n\n<p>Crie o arquivo <em>\/var\/ossec\/active-response\/bin\/portknocking.sh<\/em> com o seguinte conte\u00fado:<\/p>\n\n\n\n<pre class=\"wp-block-code\"><code>#!\/bin\/sh\n# Script para liberar porta atraves da tecnica port knocking\n# Expect: srcip\n# Author: Marcius da C. Silveira\n# Last modified: Apr 1, 2022\n# Publicado: https:\/\/marcius.pro\n\n\nACAO=$1\nUSUARIO=$2\nIP=$3\nREGRA=$5                                # Regra no wazuh referente a esse port knocking especifico\nINTWAN=`echo $9 | cut -d ',' -f1`       # Nome da interface de rede da porta wan que sera acessada externamente para liberacao da ${PORT} configurada abaixo\nTABWAN=`echo $9 | cut -d ',' -f2`       # Nome que o pfsense da a interface de rede da porta wan configurada em ${INTWAN}\nPROTO=`echo $9 | cut -d ',' -f3`        # Protocolo que sera liberado apos a sequencia de portas serem tocadas\nPORT=`echo $9 | cut -d ',' -f4`         # Porta que sera liberada no port knocking\nTIMEOUT=`echo $9 | cut -d ',' -f5`      # Tempo de espera entre o toque na primeira porta do port knocking e a ultima da sequencia, se passar desse valor em segundos a operacao nao se realizara\nEXTRAIGNOREPORTS=`echo $9 | cut -d ',' -f6 `            # Portas a serem ignoradas tambem\nARLOG=\/var\/ossec\/logs\/active-responses.log\n\n# logando as atividades desse script\necho \"`date` $0 $1 $2 $3 $4 $5 $9\" >> ${ARLOG}\n\n# Adicionar ou remover IP\n# Adicionando\nif &#91; ${ACAO} == \"add\" ]; then\n\n        # Separando as entradas no log de filtragem do pfSense referente ao IP que esta acessando esse sistema\n        LOGFILTERORIGINAL=\/var\/log\/filter.log\n        LOGFILTER=\/tmp\/conexoes_${IP}_${PORT}_${PROTO}\n        cat ${LOGFILTERORIGINAL} | grep \",\"${IP}\",\" > ${LOGFILTER}\n\n        # Se foram encontradas conexoes desse IP no log de filtragem, executa esse script\n        if &#91; `wc -l ${LOGFILTER} | awk '{print $1}'` -gt 0 ]; then\n\n                # Portas do port knocking, na sequencia que devem ser tocadas\n                PORTASK=\"`\/usr\/local\/bin\/xmllint --xpath \"pfsense\/filter\/rule&#91;starts-with(descr, 'Port Knocking ${REGRA}') and interface = '${TABWAN}']\" \/conf\/config.xml | grep \"&lt;port>\" | grep -v ^$ | cut -d \">\" -f 2 | cut -d \"&lt;\" -f1 | tr \"\\n\" \"|\" | sed 's\/.$\/\/'`\"\n\n                # Portas que serao ignoradas na contagem, tiradas das regras na tab ${TABWAN}.\n                # A intencao aqui e evitar que conexoes legitimas sejam consideradas erros de sequencia de toque no port knocking desse script.\n                IGNOREPORTS=\"`\/usr\/local\/bin\/xmllint --xpath \"pfsense\/filter\/rule&#91;interface = '${TABWAN}']\/destination\/port\" \/conf\/config.xml | cut -d \">\" -f2 | cut -d \"&lt;\" -f1 | tr \"\\n\" \"|\" | sed 's\/.$\/\/'`\"\n\n                # Removendo as portas do port knocking das portas encontradas na tab ${TABWAN} caso haja outras\n                QTDIGNOREPORTS=`echo $IGNOREPORTS | tr \"|\" \" \" | wc -w  | sed 's\/ \/\/g'`\n                QTDPORTASK=`echo $PORTASK | tr \"|\" \" \" | wc -w | sed 's\/ \/\/g'`\n                if &#91; ${QTDIGNOREPORTS} != ${QTDPORTASK} ]; then\n                        while &#91; ${QTDIGNOREPORTS} != 0 ]\n                        do\n                                QTDPRTSK=${QTDPORTASK}\n                                while &#91; ${QTDPRTSK} != 0 ]\n                                do\n                                        IPORT=`echo $IGNOREPORTS | cut -d \"|\" -f${QTDIGNOREPORTS}`\n                                        KPORT=`echo $PORTASK | cut -d \"|\" -f${QTDPRTSK}`\n                                        if &#91; ! -z ${IPORT} ]; then\n                                                if &#91; ${IPORT} = ${KPORT} ]; then\n                                                        IGNOREPORTS=`echo $IGNOREPORTS | sed 's\/^\/|\/' | sed 's\/$\/|\/' | sed \"s\/|${IPORT}|\/|\/\" | sed 's\/|$\/\/' | sed 's\/||\/|\/' | sed 's\/^|\/\/'`\n                                                fi\n                                        fi\n                                        QTDPRTSK=$((QTDPRTSK-1))\n                                done\n                                QTDIGNOREPORTS=$((QTDIGNOREPORTS-1))\n                        done\n                fi\n\n                # Adicionando a porta que sera aberta pelo port knocking e as ${EXTRAIGNOREPORTS} a variavel de portas a serem ignoradas\n                QTDEXTRAIGNOREPORTS=`echo ${EXTRAIGNOREPORTS} | tr \"|\" \" \" | wc -w | sed 's\/ \/\/g'`\n                while &#91; ${QTDEXTRAIGNOREPORTS} != 0 ]; do\n                        EIPORT=`echo ${EXTRAIGNOREPORTS} | cut -d \"|\" -f${QTDEXTRAIGNOREPORTS}`\n                                if &#91; ${EIPORT} == ${PORT} ]; then\n                                        EXTRAIGNOREPORTS=`echo ${EXTRAIGNOREPORTS} | sed \"s\/${EIPORT}\/\/\"`\n                                fi\n                        QTDEXTRAIGNOREPORTS=$((QTDEXTRAIGNOREPORTS-1))\n                done\n                if &#91; ${QTDIGNOREPORTS} != ${QTDPORTASK} ]; then\n                        IGNOREPORTS=`echo -n ${IGNOREPORTS} | sed 's\/^|\/\/' ; echo \"|\"${PORT}\"|\"${EXTRAIGNOREPORTS} | sed 's\/||\/|\/' | sed 's\/|$\/\/'`\n                else\n                        IGNOREPORTS=`echo -n ${IGNOREPORTS} | echo ${PORT}\"|\"${EXTRAIGNOREPORTS} | sed 's\/||\/|\/' | sed 's\/|$\/\/'`\n                fi\n\n                # Coletando informacoes do registro mais recente de conexao na primeira porta da sequencia do port knocking\n                PRIMEIRAPORTAK=`echo ${PORTASK} | awk -F \"|\" '{print $1}'`\n                REGPRIMEIRAPORTAK=`cat $LOGFILTER | grep -n ${IP} | grep \",${PRIMEIRAPORTAK},\" | tail -1 | sed 's\/:\/ \/' | cut -d \" \" -f1-4`\n                LINHAPRIMEIRAPORTAK=`echo ${REGPRIMEIRAPORTAK} | awk '{print $1}'`\n\n                # Analisando se o tempo entre o toque na primeira porta da sequencia e a ultima esta dentro de ${TIMEOUT} segundos\n                TSATUAL=`date +%s`\n                TSTIMEOUT=`echo \"${TSATUAL} - ${TIMEOUT}\" | bc`\n                TZANO=`date +%Z\" \"%Y`\n                DATAPRIMEIRAPORTAK=`echo ${REGPRIMEIRAPORTAK} | awk -v tzano=\"${TZANO}\" '{print $2\" \"$3\" \"$4\" \"tzano}'`\n                TSPRIMEIRAPORTAK=`echo ${DATAPRIMEIRAPORTAK} | awk '{system(\"date -jf \\\"%a %b %d %t %z %Y\\\" \\\"Mon \"$1\" \"$2\" \"$3\" \"$4\" \"$5\"\\\" \\\"+%s\\\"\")}'`\n                # Diferenca em segundos do momento em que esse script esta rodando e o toque na primeira porta da sequencia\n                # Lembrando que esse script so sera executado quando a ultima porta da sequencia do port knocking for tocada\n                DIFTS=`echo ${TSATUAL} - ${TSPRIMEIRAPORTAK} | bc `\n\n                # Separando a parte do log desde o ultimo toque dado na primeira porta da sequencia ate o final do mesmo\n                TOTALLINHASLOG=`cat $LOGFILTER | wc -l | awk '{print $1}'`\n                LINHASATEPRIMEIRAPORTAK=`echo \"(\"${TOTALLINHASLOG} - ${LINHAPRIMEIRAPORTAK}\") + 1\" | bc`\n                QTDPORTAS=`cat $LOGFILTER | grep $IP | tail -${LINHASATEPRIMEIRAPORTAK} | cut -d \",\" -f 22 | egrep -vw $IGNOREPORTS | sort | uniq | wc -l`\n                # Coletando as portas acessadas.\n                PORTASACESSADAS=`cat $LOGFILTER | grep $IP | tail -${LINHASATEPRIMEIRAPORTAK} | cut -d \",\" -f 22 | egrep -vw $IGNOREPORTS | awk -v RS=\"&#91; \\n]+\" '!n&#91;$0]++' | sed 's\/ \/\/'`\n\n                # Checando sequencia de portas acessadas\n                if &#91; ${QTDPORTAS} -eq ${QTDPORTASK} -a ${DIFTS} -le ${TIMEOUT} ]; then\n                        while &#91; ${QTDPORTAS} != 0 ]; do\n                                if &#91; `echo ${PORTASACESSADAS} | cut -d \" \" -f${QTDPORTAS}` = `echo ${PORTASK} | cut -d \"|\" -f${QTDPORTASK}` ]; then\n                                        RESULTCHECK=1\n                                        QTDPORTAS=$((QTDPORTAS-1))\n                                        QTDPORTASK=$((QTDPORTASK-1))\n                                else\n                                        echo \"`date` Sequencia invalida de portas acessadas\" >> ${ARLOG}\n                                        RESULTCHECK=0\n                                        QTDPORTAS=0\n                                        QTDPORTASK=0\n                                fi\n                        done\n                        if &#91; ${RESULTCHECK} == 1 ]; then\n                                echo \"pass in quick on ${INTWAN} proto ${PROTO} from ${IP} to port ${PORT}\" | pfctl -a \"userrules\/${IP}_${PORT}_${PROTO}\" -f -\n                                echo \"`date` Liberacao da porta ${PORT}\/${PROTO} para o IP ${IP} ativada!\" >> ${ARLOG}\n                        fi\n\n                elif &#91; ${DIFTS} -gt ${TIMEOUT} ]; then\n                        echo \"`date` Primeira porta (${PRIMEIRAPORTAK}) foi acessada a mais de ${TIMEOUT} segundos. Operacao nao realizada.\" >> ${ARLOG}\n                else\n                        echo \"`date` Sequencia invalida de portas acessadas\" >> ${ARLOG}\n                fi\n\n        else\n                echo \"`date` Sem registros de conexoes desse IP ${IP}. Nada a fazer\" >> ${ARLOG}\n        fi\n\n# Removendo ${IP}\nelif &#91; ${ACAO} == \"delete\" ]; then\n        pfctl -a \"userrules\/${IP}_${PORT}_${PROTO}\" -F rules\n        if &#91; $? = 0 ]; then\n                echo \"`date` IP ${IP} removido com sucesso!\" >> ${ARLOG}\n        else\n                echo \"Erro ao remover o IP ${IP}\" >> ${ARLOG}\n        fi\nelse\n        echo \"`date` Operacao invalida\" >> ${ARLOG}\nfi\n<\/code><\/pre>\n\n\n\n<p>D\u00ea permiss\u00e3o de execu\u00e7\u00e3o para o script:<\/p>\n\n\n\n<pre class=\"wp-block-code\"><code>chmod +x \/var\/ossec\/active-response\/bin\/portknocking.sh<\/code><\/pre>\n\n\n\n<h2>..::| Portas para libera\u00e7\u00e3o de conex\u00e3o<\/h2>\n\n\n\n<p>Agora vamos criar as regras no pfSense para as portas que, quando tocadas na sequ\u00eancia correta, liberar\u00e3o as portas do servi\u00e7o SSH e a do HTTP. Essas regras ser\u00e3o de bloqueio, pois o que queremos \u00e9 apenas logar os toques nelas.<\/p>\n\n\n\n<p>Escolhi a sequ\u00eancia de portas <strong>1111<\/strong>, <strong>1000<\/strong> e <strong>2000<\/strong>, para liberar a porta <strong>22\/TCP<\/strong>, e as portas <strong>11<\/strong>, <strong>52<\/strong> e <strong>40<\/strong> para liberar a porta <strong>80\/TCP<\/strong>. Todas com o protocolo TCP.<\/p>\n\n\n\n<p>\u00c9 recomendado usar, no m\u00ednimo, 3 portas e que n\u00e3o sejam sequ\u00eanciais (por exemplo: 1000, 1001 e 1002) para cada libera\u00e7\u00e3o pois, em casos de descoberta da primeira por um atacante, as demais seriam meio \u00f3bvias de adivinhar. Tamb\u00e9m \u00e9 necess\u00e1rio marcar a op\u00e7\u00e3o de logar essas regras, para que os toques sejam registrados no <em>\/var\/log\/filter.log<\/em>.<\/p>\n\n\n\n<p>Caso queira criar mais do que 3 portas de toques, basta cri\u00e1-la(s) no pfSense. O script reconhece automaticamente quantas portas s\u00e3o necess\u00e1rias nessa t\u00e9cnica.<\/p>\n\n\n\n<p>Na descri\u00e7\u00e3o de cada regra h\u00e1 um <strong>padr\u00e3o extremamente importante<\/strong> para que o script funcione corretamente. Sempre escreva &#8220;<em>Port Knocking (n\u00famero da regra no wazuh)<\/em>&#8221; pois o script ir\u00e1 procurar nesse campo as portas correspondentes ao Port Knocking em quest\u00e3o. Cada regra no wazuh (que ser\u00e3o criadas mais tarde) corresponde a uma libera\u00e7\u00e3o.<\/p>\n\n\n\n<figure class=\"wp-block-image size-full\"><img loading=\"lazy\" width=\"1042\" height=\"905\" src=\"http:\/\/10.0.0.181\/wp-content\/uploads\/2022\/03\/3-criacao-regras-pfsense.png\" alt=\"\" class=\"wp-image-112\"\/><figcaption>\u00c9 muito importante colocar a descri\u00e7\u00e3o da regra corretamente, seguindo o padr\u00e3o acima descrito<\/figcaption><\/figure>\n\n\n\n<p>Crie todas as regras tal como a que foi criada na imagem acima, para cada uma das 6 portas (<strong>1111<\/strong>, <strong>1000<\/strong>, <strong>2000<\/strong> com a descri\u00e7\u00e3o &#8220;<em>Port Knocking 100001<\/em>&#8221; e <strong>11<\/strong>, <strong>52<\/strong> e <strong>40<\/strong> com a descri\u00e7\u00e3o &#8220;<em>Port Knocking 100002<\/em>&#8220;), ficando a tabela de regras WAN assim:<\/p>\n\n\n\n<figure class=\"wp-block-image size-full\"><img loading=\"lazy\" width=\"1169\" height=\"397\" src=\"http:\/\/10.0.0.181\/wp-content\/uploads\/2022\/03\/3-regras-pk-pfsense.png\" alt=\"\" class=\"wp-image-113\"\/><figcaption>A ordem das regras ser\u00e1 a sequ\u00eancia em que cada porta dever\u00e1 ser tocada<\/figcaption><\/figure>\n\n\n\n<p>Aqui voc\u00ea tamb\u00e9m define a ordem em que as portas devem ser tocadas. Ent\u00e3o ap\u00f3s a cria\u00e7\u00e3o das regras, coloque-as na ordem em que elas devem ser tocadas. Mesmo que os toques acertem as 3 portas, se n\u00e3o forem tocadas na ordem correta o script n\u00e3o ir\u00e1 liberar a porta do servi\u00e7o solicitado.<\/p>\n\n\n\n<p>No exemplo acima n\u00e3o h\u00e1 outras regras al\u00e9m das desse artigo, mas se houvessem o script iria ignor\u00e1-las automaticamente para evitar que uma conex\u00e3o leg\u00edtima interfira na verifica\u00e7\u00e3o dos toques.<\/p>\n\n\n\n<p>No servidor Debian crie as seguintes regras no arquivo <em>\/var\/ossec\/etc\/rules\/local_rules.xml<\/em>:<\/p>\n\n\n\n<pre class=\"wp-block-code\"><code>  &lt;rule id=\"100001\" level=\"5\">\n    &lt;if_sid>87701&lt;\/if_sid>\n    &lt;dstport>2000&lt;\/dstport>\n    &lt;description>Port knocking da porta SSH padrao&lt;\/description>\n  &lt;\/rule>\n\n  &lt;rule id=\"100002\" level=\"5\">\n    &lt;if_sid>87701&lt;\/if_sid>\n    &lt;dstport>40&lt;\/dstport>\n    &lt;description>Port knocking da porta HTTP padrao&lt;\/description>\n  &lt;\/rule><\/code><\/pre>\n\n\n\n<figure class=\"wp-block-image size-full\"><img loading=\"lazy\" width=\"875\" height=\"512\" src=\"http:\/\/10.0.0.181\/wp-content\/uploads\/2022\/03\/3-local-rules.png\" alt=\"\" class=\"wp-image-115\"\/><figcaption>Note que em &lt;dstport> foram colocadas apenas as \u00faltimas portas das sequ\u00eancias de cada libera\u00e7\u00e3o<\/figcaption><\/figure>\n\n\n\n<p>Acima foram criadas duas regras, uma para cada libera\u00e7\u00e3o (SSH e HTTP). Elas ser\u00e3o ativadas quando a \u00faltima porta, da sequ\u00eancia correspondente ao servi\u00e7o a ser liberado, for tocada pois assim significa que todas as anteriores necess\u00e1rias j\u00e1 foram acessadas e, portanto, j\u00e1 logadas para serem lidas pelo script. Note que o n\u00famero de cada regra (dentro de <em>&lt;rule id=&#8221;<\/em>) corresponde a descri\u00e7\u00e3o das regras criadas no pfSense anteriormente.<\/p>\n\n\n\n<p>Acrescente o comando e o active-response a seguir no arquivo <em>\/var\/ossec\/etc\/ossec.conf<\/em>, logo ap\u00f3s o \u00faltimo <em>&lt;\/command><\/em>:<\/p>\n\n\n\n<pre class=\"wp-block-code\"><code>  &lt;command>\n    &lt;name>portknocking-ssh&lt;\/name>\n    &lt;executable>portknocking.sh&lt;\/executable>\n    &lt;!-- Adicione as seguintes informacoes separadas por virgula: nome da interface no SO, nome da interface wan no pfsense, protocolo, porta que sera liberada,\n        tempo (em segundos) entre os toques das portas, portas extras a ignorar (separadas por pipe |) -->\n    &lt;extra_args>em0,wan,tcp,22,120,22|80&lt;\/extra_args>\n    &lt;timeout_allowed>yes&lt;\/timeout_allowed>\n  &lt;\/command>\n\n  &lt;command>\n    &lt;name>portknocking-http&lt;\/name>\n    &lt;executable>portknocking.sh&lt;\/executable>\n    &lt;!-- Adicione as seguintes informacoes separadas por virgula: nome da interface no SO, nome da interface wan no pfsense, protocolo, porta que sera liberada,\n        tempo (em segundos) entre os toques das portas, portas extras a ignorar (separadas por pipe |) -->\n    &lt;extra_args>em0,wan,tcp,80,120,80|22&lt;\/extra_args>\n    &lt;timeout_allowed>yes&lt;\/timeout_allowed>\n  &lt;\/command>\n\n  &lt;active-response>\n    &lt;command>portknocking-ssh&lt;\/command>\n    &lt;location>defined-agent&lt;\/location>\n    &lt;agent_id>002&lt;\/agent_id>\n    &lt;rules_id>100001&lt;\/rules_id>\n    &lt;disabled>no&lt;\/disabled>\n    &lt;timeout>60&lt;\/timeout>\n  &lt;\/active-response>\n\n  &lt;active-response>\n    &lt;command>portknocking-http&lt;\/command>\n    &lt;location>defined-agent&lt;\/location>\n    &lt;agent_id>002&lt;\/agent_id>\n    &lt;rules_id>100002&lt;\/rules_id>\n    &lt;disabled>no&lt;\/disabled>\n    &lt;timeout>60&lt;\/timeout>\n  &lt;\/active-response>\n<\/code><\/pre>\n\n\n\n<figure class=\"wp-block-image size-full\"><img loading=\"lazy\" width=\"1608\" height=\"885\" src=\"http:\/\/10.0.0.181\/wp-content\/uploads\/2022\/03\/3-command-ar-1.png\" alt=\"\" class=\"wp-image-144\"\/><\/figure>\n\n\n\n<p>Veja que em <em>&lt;extra_args>&lt;\/extra_args><\/em> h\u00e1 informa\u00e7\u00f5es importantes (separadas por v\u00edrgula) que precisam ser passadas ao <em>portknocking.sh<\/em>, que s\u00e3o:<\/p>\n\n\n\n<ul><li>Nome da interface WAN reconhecida pelo FreeBSD<\/li><\/ul>\n\n\n\n<figure class=\"wp-block-image size-full\"><img loading=\"lazy\" width=\"1161\" height=\"312\" src=\"http:\/\/10.0.0.181\/wp-content\/uploads\/2022\/03\/3-em0.png\" alt=\"\" class=\"wp-image-119\"\/><\/figure>\n\n\n\n<ul><li>Nome da interface WAN dada pelo pfSense<\/li><\/ul>\n\n\n\n<figure class=\"wp-block-image size-full\"><img loading=\"lazy\" width=\"1161\" height=\"312\" src=\"http:\/\/10.0.0.181\/wp-content\/uploads\/2022\/03\/3-wan.png\" alt=\"\" class=\"wp-image-120\"\/><\/figure>\n\n\n\n<ul><li>Protocolo do servi\u00e7o que ser\u00e1 liberado<\/li><li>Porta que ser\u00e1 liberada<\/li><li>Tempo m\u00e1ximo (em segundos) entre o toque na primeira porta da sequ\u00eancia e a \u00faltima<\/li><li>Portas que ser\u00e3o ignoradas na verifica\u00e7\u00e3o dos toques. Deve-se colocar as portas que forem usadas em outras libera\u00e7\u00f5es.<\/li><\/ul>\n\n\n\n<p>A ordem em que essas informa\u00e7\u00f5es s\u00e3o colocadas \u00e9 vital para o correto funcionamento do script de libera\u00e7\u00e3o.<\/p>\n\n\n\n<p>Al\u00e9m disso, outra configura\u00e7\u00e3o muito importante \u00e9 quanto ao tempo em que a regra de libera\u00e7\u00e3o de conex\u00e3o ao servi\u00e7o ficar\u00e1 ativa. Dentro da tag <em>&lt;timeout>&lt;\/timeout><\/em> voc\u00ea estipula esse tempo em segundos.<\/p>\n\n\n\n<p>Reinicie o wazuh-manager:<\/p>\n\n\n\n<pre class=\"wp-block-code\"><code>systemctl restart wazuh-manager<\/code><\/pre>\n\n\n\n<p>Se o pfSense foi rec\u00e9m instalado, os hor\u00e1rios no <em>\/var\/log\/filter.log<\/em> estar\u00e3o diferentes da data do sistema operacional, gerando erro no script. Pra resolver, basta reiniciar o pfSense.<\/p>\n\n\n\n<p>Lembrando que a regra de libera\u00e7\u00e3o criada ap\u00f3s a sequ\u00eancia correta de toques nas portas do Port Knocking s\u00f3 \u00e9 vis\u00edvel pelo comando <em>pfctl<\/em>, portanto n\u00e3o aparecer\u00e1 no painel administrativo do pfSense, j\u00e1 que ela n\u00e3o foi criada via <em>easyrules<\/em> (porque atrav\u00e9s desse comando n\u00e3o \u00e9 poss\u00edvel remover uma regra criada, por isso tive que usar o <em>pfctl<\/em>).<\/p>\n\n\n\n<h2>..::| Limita\u00e7\u00f5es<\/h2>\n\n\n\n<p>Quando o active-response do Wazuh \u00e9 ativado para um determinado IP de origem, esse mesmo IP n\u00e3o consegue ativar outro active-response enquanto o primeiro ainda estiver ativo. Como o script \u00e9 executado no pfSense, o mesmo n\u00e3o tem como avisar o Wazuh quando, por exemplo, uma sequ\u00eancia de portas forem tocadas na ordem errada, e assim evitar a execu\u00e7\u00e3o do active-response. Ele \u00e9 executado quando a \u00faltima porta da sequ\u00eancia \u00e9 tocada, mesmo que ela esteja errada, e ficar\u00e1 ativo at\u00e9 o seu timeout expirar. Portanto, caso erre a sequ\u00eancia uma vez, deve-se esperar o tempo configurado em que a libera\u00e7\u00e3o estivesse ativa, para ent\u00e3o fazer uma nova tentativa (tags <em>&lt;timeout>&lt;\/timeout><\/em> no <em>\/var\/ossec\/etc\/ossec.conf<\/em> na se\u00e7\u00e3o do <em>&lt;active-response>&lt;\/active-response><\/em>).<\/p>\n\n\n\n<p>Por causa dessa limita\u00e7\u00e3o, recomenda-se um timeout pequeno, de uns 5 minutos, s\u00f3 para fazer uma manuten\u00e7\u00e3o r\u00e1pida remotamente. Caso precise de mais tempo, o recomendado \u00e9 criar uma regra diretamente no pfSense liberando a conex\u00e3o para o seu IP de origem.<\/p>\n\n\n\n<p>Por conta do que foi dito acima, tamb\u00e9m n\u00e3o \u00e9 poss\u00edvel liberar as portas 22\/TCP e 80\/TCP ao mesmo tempo via Port Knocking. Quando uma for ativada, deve-se esperar o timeout dela passar para fazer o Port Knocking na outra.<\/p>\n\n\n\n<h2>..::| Testes<\/h2>\n\n\n\n<p>De um sistema linux, instale o <em>curl<\/em> e d\u00ea o seguinte comando (certifique-se que esse linux alcance a interface WAN do pfSense):<\/p>\n\n\n\n<pre class=\"wp-block-code\"><code>curl --connect-timeout 1 http:\/\/10.0.0.200:1111 ; curl --connect-timeout 1 http:\/\/10.0.0.200:1000 ; curl --connect-timeout 1 http:\/\/10.0.0.200:2000 ; ssh root@10.0.0.200<\/code><\/pre>\n\n\n\n<figure class=\"wp-block-image size-full\"><img loading=\"lazy\" width=\"1900\" height=\"473\" src=\"http:\/\/10.0.0.181\/wp-content\/uploads\/2022\/03\/3-test-ssh.png\" alt=\"\" class=\"wp-image-124\"\/><figcaption>Veja que, ap\u00f3s os 3 toques feitos pelo comando curl, o prompt de autentica\u00e7\u00e3o SSH do pfSense \u00e9 mostrado<\/figcaption><\/figure>\n\n\n\n<p>Para verificar se a regra de libera\u00e7\u00e3o da porta do SSH foi criada com sucesso via <em>pfctl<\/em>, execute o comando no shell do pfSense:<\/p>\n\n\n\n<pre class=\"wp-block-code\"><code>pfctl -a \"userrules\/IP_PORTA_PROTOCOLO\" -sr<\/code><\/pre>\n\n\n\n<p>Por exemplo, se o IP <strong>10.0.0.182<\/strong> pediu libera\u00e7\u00e3o da porta <strong>22<\/strong> do protocolo <strong>TCP<\/strong>, o comando acima ficar\u00e1:<\/p>\n\n\n\n<pre class=\"wp-block-code\"><code>pfctl -a \"userrules\/10.0.0.182_22_tcp\" -sr<\/code><\/pre>\n\n\n\n<figure class=\"wp-block-image size-full\"><img loading=\"lazy\" width=\"920\" height=\"62\" src=\"http:\/\/10.0.0.181\/wp-content\/uploads\/2022\/03\/3-pfctl-ssh.png\" alt=\"\" class=\"wp-image-126\"\/><\/figure>\n\n\n\n<p>No Windows, pode-se usar o PowerShell com o comando Test-NetConnection. Exemplo para a libera\u00e7\u00e3o da porta 22\/TCP desse artigo:<\/p>\n\n\n\n<pre class=\"wp-block-code\"><code>Test-NetConnection -Port 1111 10.0.0.200\nTest-NetConnection -Port 1000 10.0.0.200\nTest-NetConnection -Port 2000 10.0.0.200<\/code><\/pre>\n\n\n\n<h2>..::| Conclus\u00e3o<\/h2>\n\n\n\n<p>Port Knocking \u00e9 uma t\u00e9cnica que insere uma camada a mais de seguran\u00e7a para o acesso externo a sua rede. Com ele podemos evitar ataques de for\u00e7a bruta, por exemplo, e at\u00e9 ataques a aplicativos web em vulnerabilidades ainda n\u00e3o corrigidas. N\u00e3o deixando uma porta sempre aberta para qualquer IP de origem bloqueia a detec\u00e7\u00e3o delas por escaneadores.<\/p>\n\n\n\n<p>Se um administrador de rede est\u00e1 em uma situa\u00e7\u00e3o em que n\u00e3o pode realizar uma conex\u00e3o VPN a sua rede, ele poder\u00e1 acessar o roteador se lembrar das 3 (ou mais) portas que devem ser tocadas antes da libera\u00e7\u00e3o de uma porta para um servi\u00e7o administrativo desse roteador, e assim poder\u00e1 criar outras regras para uma outra conex\u00e3o, entre outras manuten\u00e7\u00f5es poss\u00edveis. O fato dessa porta administrativa ser liberada apenas para o IP de origem que efetuou os toques do Port Knocking, e com tempo dessa libera\u00e7\u00e3o ser pr\u00e9-determinado, torna essa t\u00e9cnica excelente para que o seu firewall seja mais eficaz.<\/p>\n\n\n\n<p>Em casos onde \u00e9 poss\u00edvel estabelecer uma VPN, o Port Knocking tamb\u00e9m \u00e9 \u00fatil pois poder\u00e1 proteger a porta de conex\u00e3o desse servi\u00e7o. N\u00e3o haveria necessidade de deixar essa porta sempre aberta para conex\u00f5es. Nesse caso \u00e9 recomendado criar um script, no lado do cliente, com os 3 (ou mais) toques j\u00e1 configurados para que se possa colocar um tempo maior de libera\u00e7\u00e3o (timeout) sem temer errar a sequ\u00eancia de portas, o que faria com que a porta do servi\u00e7o solicitado ficasse inacess\u00edvel pelo mesmo per\u00edodo em que estaria liberada. Geralmente uma VPN \u00e9 necess\u00e1ria para per\u00edodos maiores de uso, por isso o timeout maior, nesse caso. Lembrando que o timeout vale para todos os active-response referente ao IP de origem.<\/p>\n\n\n\n<p>O Wazuh tem a capacidade de enviar e-mails de alertas para o administrador quando uma regra \u00e9 acionada, mediante configura\u00e7\u00e3o nela. Ou seja, \u00e9 poss\u00edvel monitorar os acessos por Port Knocking, bastando apenas configurar as regras no Wazuh referente a essa t\u00e9cnica para que enviem e-mails sempre que ativadas.<\/p>\n\n\n\n<p><\/p>\n\n\n\n<blockquote class=\"wp-block-quote\"><p>Fontes:<\/p><p><a href=\"https:\/\/documentation.wazuh.com\/current\/user-manual\/capabilities\/active-response\/custom-active-response.html\" target=\"_blank\" rel=\"noreferrer noopener\">https:\/\/documentation.wazuh.com\/current\/user-manual\/capabilities\/active-response\/custom-active-response.html<\/a><br><a href=\"https:\/\/forum.netgate.com\/topic\/147951\/create-firewall-rules-by-script\/4\" target=\"_blank\" rel=\"noreferrer noopener\">https:\/\/forum.netgate.com\/topic\/147951\/create-firewall-rules-by-script\/4<\/a><br><a href=\"https:\/\/www.openbsd.org\/faq\/pf\/anchors.html\" target=\"_blank\" rel=\"noreferrer noopener\">https:\/\/www.openbsd.org\/faq\/pf\/anchors.html<\/a><br><a href=\"http:\/\/woshub.com\/checking-tcp-port-response-using-powershell\/\" target=\"_blank\" rel=\"noreferrer noopener\">http:\/\/woshub.com\/checking-tcp-port-response-using-powershell\/<\/a><\/p><\/blockquote>\n","protected":false},"excerpt":{"rendered":"<p>Esconda portas importantes no seu pfSense e abra elas especificamente para o seu IP externo atrav\u00e9s de toques de conex\u00f5es em 3 ou mais portas bloqueadas, com uma sequ\u00eancia secreta.<\/p>\n","protected":false},"author":1,"featured_media":109,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":[],"categories":[5],"tags":[],"yoast_head":"<!-- This site is optimized with the Yoast SEO plugin v18.3 - https:\/\/yoast.com\/wordpress\/plugins\/seo\/ -->\n<title>Port Knocking no pfSense usando Wazuh - Marcius Costa<\/title>\n<meta name=\"description\" content=\"Esconda portas importantes no seu pfSense e abra elas especificamente para o seu IP externo atrav\u00e9s de toques de conex\u00f5es em 3 ou mais portas bloqueadas, com uma sequ\u00eancia secreta.\" \/>\n<meta name=\"robots\" content=\"index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1\" \/>\n<link rel=\"canonical\" href=\"http:\/\/10.0.0.181\/index.php\/2022\/03\/31\/port-knocking-no-pfsense-usando-wazuh\/\" \/>\n<meta property=\"og:locale\" content=\"pt_BR\" \/>\n<meta property=\"og:type\" content=\"article\" \/>\n<meta property=\"og:title\" content=\"Port Knocking no pfSense usando Wazuh\" \/>\n<meta property=\"og:description\" content=\"Esconda portas importantes no seu pfSense e abra elas especificamente para o seu IP externo atrav\u00e9s de toques de conex\u00f5es em 3 ou mais portas bloqueadas, com uma sequ\u00eancia secreta.\" \/>\n<meta property=\"og:url\" content=\"http:\/\/10.0.0.181\/index.php\/2022\/03\/31\/port-knocking-no-pfsense-usando-wazuh\/\" \/>\n<meta property=\"og:site_name\" content=\"Marcius Costa\" \/>\n<meta property=\"article:published_time\" content=\"2022-03-31T18:31:33+00:00\" \/>\n<meta property=\"article:modified_time\" content=\"2022-04-01T21:06:47+00:00\" \/>\n<meta property=\"og:image\" content=\"http:\/\/10.0.0.181\/wp-content\/uploads\/2022\/03\/3-titulo.png\" \/>\n\t<meta property=\"og:image:width\" content=\"1200\" \/>\n\t<meta property=\"og:image:height\" content=\"675\" \/>\n\t<meta property=\"og:image:type\" content=\"image\/png\" \/>\n<meta name=\"twitter:card\" content=\"summary_large_image\" \/>\n<meta name=\"twitter:label1\" content=\"Escrito por\" \/>\n\t<meta name=\"twitter:data1\" content=\"marcius\" \/>\n\t<meta name=\"twitter:label2\" content=\"Est. tempo de leitura\" \/>\n\t<meta name=\"twitter:data2\" content=\"18 minutos\" \/>\n<script type=\"application\/ld+json\" class=\"yoast-schema-graph\">{\"@context\":\"https:\/\/schema.org\",\"@graph\":[{\"@type\":\"WebSite\",\"@id\":\"http:\/\/10.0.0.181\/#website\",\"url\":\"http:\/\/10.0.0.181\/\",\"name\":\"Marcius Costa\",\"description\":\"Profissional em redes de computadores e seguran\u00e7a cibern\u00e9tica\",\"potentialAction\":[{\"@type\":\"SearchAction\",\"target\":{\"@type\":\"EntryPoint\",\"urlTemplate\":\"http:\/\/10.0.0.181\/?s={search_term_string}\"},\"query-input\":\"required name=search_term_string\"}],\"inLanguage\":\"pt-BR\"},{\"@type\":\"ImageObject\",\"@id\":\"http:\/\/10.0.0.181\/index.php\/2022\/03\/31\/port-knocking-no-pfsense-usando-wazuh\/#primaryimage\",\"inLanguage\":\"pt-BR\",\"url\":\"http:\/\/10.0.0.181\/wp-content\/uploads\/2022\/03\/3-titulo.png\",\"contentUrl\":\"http:\/\/10.0.0.181\/wp-content\/uploads\/2022\/03\/3-titulo.png\",\"width\":1200,\"height\":675},{\"@type\":\"WebPage\",\"@id\":\"http:\/\/10.0.0.181\/index.php\/2022\/03\/31\/port-knocking-no-pfsense-usando-wazuh\/#webpage\",\"url\":\"http:\/\/10.0.0.181\/index.php\/2022\/03\/31\/port-knocking-no-pfsense-usando-wazuh\/\",\"name\":\"Port Knocking no pfSense usando Wazuh - Marcius Costa\",\"isPartOf\":{\"@id\":\"http:\/\/10.0.0.181\/#website\"},\"primaryImageOfPage\":{\"@id\":\"http:\/\/10.0.0.181\/index.php\/2022\/03\/31\/port-knocking-no-pfsense-usando-wazuh\/#primaryimage\"},\"datePublished\":\"2022-03-31T18:31:33+00:00\",\"dateModified\":\"2022-04-01T21:06:47+00:00\",\"author\":{\"@id\":\"http:\/\/10.0.0.181\/#\/schema\/person\/06a29c6c112f692c476fb671fa556a4a\"},\"description\":\"Esconda portas importantes no seu pfSense e abra elas especificamente para o seu IP externo atrav\u00e9s de toques de conex\u00f5es em 3 ou mais portas bloqueadas, com uma sequ\u00eancia secreta.\",\"breadcrumb\":{\"@id\":\"http:\/\/10.0.0.181\/index.php\/2022\/03\/31\/port-knocking-no-pfsense-usando-wazuh\/#breadcrumb\"},\"inLanguage\":\"pt-BR\",\"potentialAction\":[{\"@type\":\"ReadAction\",\"target\":[\"http:\/\/10.0.0.181\/index.php\/2022\/03\/31\/port-knocking-no-pfsense-usando-wazuh\/\"]}]},{\"@type\":\"BreadcrumbList\",\"@id\":\"http:\/\/10.0.0.181\/index.php\/2022\/03\/31\/port-knocking-no-pfsense-usando-wazuh\/#breadcrumb\",\"itemListElement\":[{\"@type\":\"ListItem\",\"position\":1,\"name\":\"In\u00edcio\",\"item\":\"http:\/\/10.0.0.181\/\"},{\"@type\":\"ListItem\",\"position\":2,\"name\":\"Port Knocking no pfSense usando Wazuh\"}]},{\"@type\":\"Person\",\"@id\":\"http:\/\/10.0.0.181\/#\/schema\/person\/06a29c6c112f692c476fb671fa556a4a\",\"name\":\"marcius\",\"image\":{\"@type\":\"ImageObject\",\"@id\":\"http:\/\/10.0.0.181\/#personlogo\",\"inLanguage\":\"pt-BR\",\"url\":\"http:\/\/0.gravatar.com\/avatar\/c913a61ab6c4834155e669573c13b12c?s=96&d=mm&r=g\",\"contentUrl\":\"http:\/\/0.gravatar.com\/avatar\/c913a61ab6c4834155e669573c13b12c?s=96&d=mm&r=g\",\"caption\":\"marcius\"},\"sameAs\":[\"http:\/\/localhost\"],\"url\":\"http:\/\/10.0.0.181\/index.php\/author\/marcius\/\"}]}<\/script>\n<!-- \/ Yoast SEO plugin. -->","yoast_head_json":{"title":"Port Knocking no pfSense usando Wazuh - Marcius Costa","description":"Esconda portas importantes no seu pfSense e abra elas especificamente para o seu IP externo atrav\u00e9s de toques de conex\u00f5es em 3 ou mais portas bloqueadas, com uma sequ\u00eancia secreta.","robots":{"index":"index","follow":"follow","max-snippet":"max-snippet:-1","max-image-preview":"max-image-preview:large","max-video-preview":"max-video-preview:-1"},"canonical":"http:\/\/10.0.0.181\/index.php\/2022\/03\/31\/port-knocking-no-pfsense-usando-wazuh\/","og_locale":"pt_BR","og_type":"article","og_title":"Port Knocking no pfSense usando Wazuh","og_description":"Esconda portas importantes no seu pfSense e abra elas especificamente para o seu IP externo atrav\u00e9s de toques de conex\u00f5es em 3 ou mais portas bloqueadas, com uma sequ\u00eancia secreta.","og_url":"http:\/\/10.0.0.181\/index.php\/2022\/03\/31\/port-knocking-no-pfsense-usando-wazuh\/","og_site_name":"Marcius Costa","article_published_time":"2022-03-31T18:31:33+00:00","article_modified_time":"2022-04-01T21:06:47+00:00","og_image":[{"width":1200,"height":675,"url":"http:\/\/10.0.0.181\/wp-content\/uploads\/2022\/03\/3-titulo.png","type":"image\/png"}],"twitter_card":"summary_large_image","twitter_misc":{"Escrito por":"marcius","Est. tempo de leitura":"18 minutos"},"schema":{"@context":"https:\/\/schema.org","@graph":[{"@type":"WebSite","@id":"http:\/\/10.0.0.181\/#website","url":"http:\/\/10.0.0.181\/","name":"Marcius Costa","description":"Profissional em redes de computadores e seguran\u00e7a cibern\u00e9tica","potentialAction":[{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"http:\/\/10.0.0.181\/?s={search_term_string}"},"query-input":"required name=search_term_string"}],"inLanguage":"pt-BR"},{"@type":"ImageObject","@id":"http:\/\/10.0.0.181\/index.php\/2022\/03\/31\/port-knocking-no-pfsense-usando-wazuh\/#primaryimage","inLanguage":"pt-BR","url":"http:\/\/10.0.0.181\/wp-content\/uploads\/2022\/03\/3-titulo.png","contentUrl":"http:\/\/10.0.0.181\/wp-content\/uploads\/2022\/03\/3-titulo.png","width":1200,"height":675},{"@type":"WebPage","@id":"http:\/\/10.0.0.181\/index.php\/2022\/03\/31\/port-knocking-no-pfsense-usando-wazuh\/#webpage","url":"http:\/\/10.0.0.181\/index.php\/2022\/03\/31\/port-knocking-no-pfsense-usando-wazuh\/","name":"Port Knocking no pfSense usando Wazuh - Marcius Costa","isPartOf":{"@id":"http:\/\/10.0.0.181\/#website"},"primaryImageOfPage":{"@id":"http:\/\/10.0.0.181\/index.php\/2022\/03\/31\/port-knocking-no-pfsense-usando-wazuh\/#primaryimage"},"datePublished":"2022-03-31T18:31:33+00:00","dateModified":"2022-04-01T21:06:47+00:00","author":{"@id":"http:\/\/10.0.0.181\/#\/schema\/person\/06a29c6c112f692c476fb671fa556a4a"},"description":"Esconda portas importantes no seu pfSense e abra elas especificamente para o seu IP externo atrav\u00e9s de toques de conex\u00f5es em 3 ou mais portas bloqueadas, com uma sequ\u00eancia secreta.","breadcrumb":{"@id":"http:\/\/10.0.0.181\/index.php\/2022\/03\/31\/port-knocking-no-pfsense-usando-wazuh\/#breadcrumb"},"inLanguage":"pt-BR","potentialAction":[{"@type":"ReadAction","target":["http:\/\/10.0.0.181\/index.php\/2022\/03\/31\/port-knocking-no-pfsense-usando-wazuh\/"]}]},{"@type":"BreadcrumbList","@id":"http:\/\/10.0.0.181\/index.php\/2022\/03\/31\/port-knocking-no-pfsense-usando-wazuh\/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"name":"In\u00edcio","item":"http:\/\/10.0.0.181\/"},{"@type":"ListItem","position":2,"name":"Port Knocking no pfSense usando Wazuh"}]},{"@type":"Person","@id":"http:\/\/10.0.0.181\/#\/schema\/person\/06a29c6c112f692c476fb671fa556a4a","name":"marcius","image":{"@type":"ImageObject","@id":"http:\/\/10.0.0.181\/#personlogo","inLanguage":"pt-BR","url":"http:\/\/0.gravatar.com\/avatar\/c913a61ab6c4834155e669573c13b12c?s=96&d=mm&r=g","contentUrl":"http:\/\/0.gravatar.com\/avatar\/c913a61ab6c4834155e669573c13b12c?s=96&d=mm&r=g","caption":"marcius"},"sameAs":["http:\/\/localhost"],"url":"http:\/\/10.0.0.181\/index.php\/author\/marcius\/"}]}},"_links":{"self":[{"href":"http:\/\/10.0.0.181\/index.php\/wp-json\/wp\/v2\/posts\/107"}],"collection":[{"href":"http:\/\/10.0.0.181\/index.php\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"http:\/\/10.0.0.181\/index.php\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"http:\/\/10.0.0.181\/index.php\/wp-json\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"http:\/\/10.0.0.181\/index.php\/wp-json\/wp\/v2\/comments?post=107"}],"version-history":[{"count":58,"href":"http:\/\/10.0.0.181\/index.php\/wp-json\/wp\/v2\/posts\/107\/revisions"}],"predecessor-version":[{"id":180,"href":"http:\/\/10.0.0.181\/index.php\/wp-json\/wp\/v2\/posts\/107\/revisions\/180"}],"wp:featuredmedia":[{"embeddable":true,"href":"http:\/\/10.0.0.181\/index.php\/wp-json\/wp\/v2\/media\/109"}],"wp:attachment":[{"href":"http:\/\/10.0.0.181\/index.php\/wp-json\/wp\/v2\/media?parent=107"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"http:\/\/10.0.0.181\/index.php\/wp-json\/wp\/v2\/categories?post=107"},{"taxonomy":"post_tag","embeddable":true,"href":"http:\/\/10.0.0.181\/index.php\/wp-json\/wp\/v2\/tags?post=107"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}